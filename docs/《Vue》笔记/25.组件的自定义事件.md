---
title: ç»„ä»¶çš„è‡ªå®šä¹‰äº‹ä»¶
date: 2022-07-08 16:09:11
permalink: /pages/37ea71/
categories:
  - Vue
tags:
  - 
author: 
  name: yami
  link: https://github.com/yamin-hub
---
## ç»„ä»¶çš„è‡ªå®šä¹‰äº‹ä»¶

1. ä¸€ç§ç»„ä»¶é—´é€šä¿¡çš„æ–¹å¼ï¼Œé€‚ç”¨äºï¼š<strong style="color:red">å­ç»„ä»¶ ===> çˆ¶ç»„ä»¶</strong>

2. ä½¿ç”¨åœºæ™¯ï¼šAæ˜¯çˆ¶ç»„ä»¶ï¼ŒBæ˜¯å­ç»„ä»¶ï¼ŒBæƒ³ç»™Aä¼ æ•°æ®ï¼Œé‚£ä¹ˆå°±è¦åœ¨Aä¸­ç»™Bç»‘å®šè‡ªå®šä¹‰äº‹ä»¶ï¼ˆ<span style="color:red">äº‹ä»¶çš„å›è°ƒåœ¨Aä¸­</span>ï¼‰ã€‚

3. ç»‘å®šè‡ªå®šä¹‰äº‹ä»¶ï¼š

   1. ç¬¬ä¸€ç§æ–¹å¼ï¼Œåœ¨çˆ¶ç»„ä»¶ä¸­ï¼š```<Demo @atguigu="test"/>```  æˆ– ```<Demo v-on:atguigu="test"/>```

   2. ç¬¬äºŒç§æ–¹å¼ï¼Œåœ¨çˆ¶ç»„ä»¶ä¸­ï¼š

      ```js
      <Demo ref="demo"/>
      ......
      mounted(){
         this.$refs.xxx.$on('atguigu',this.test)
      }
      ```

   3. è‹¥æƒ³è®©è‡ªå®šä¹‰äº‹ä»¶åªèƒ½è§¦å‘ä¸€æ¬¡ï¼Œå¯ä»¥ä½¿ç”¨```once```ä¿®é¥°ç¬¦ï¼Œæˆ–```$once```æ–¹æ³•ã€‚

4. è§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼š```this.$emit('atguigu',æ•°æ®)```		

5. è§£ç»‘è‡ªå®šä¹‰äº‹ä»¶```this.$off('atguigu')```

6. ç»„ä»¶ä¸Šä¹Ÿå¯ä»¥ç»‘å®šåŸç”ŸDOMäº‹ä»¶ï¼Œéœ€è¦ä½¿ç”¨```native```ä¿®é¥°ç¬¦ã€‚ä¾‹å¦‚`@click.native`,ä½¿ç”¨`@click`æ˜¯è‡ªå®šä¹‰äº‹ä»¶

7. æ³¨æ„ï¼šé€šè¿‡```this.$refs.xxx.$on('atguigu',å›è°ƒ)```ç»‘å®šè‡ªå®šä¹‰äº‹ä»¶æ—¶ï¼Œå›è°ƒ<span style="color:red">è¦ä¹ˆé…ç½®åœ¨methodsä¸­</span>ï¼Œ<span style="color:red">è¦ä¹ˆç”¨ç®­å¤´å‡½æ•°</span>ï¼Œå¦åˆ™thisæŒ‡å‘ä¼šå‡ºé—®é¢˜ï¼Œè¯¥thisä¼šæŒ‡å‘è§¦å‘çš„ç»„ä»¶å®ä¾‹ã€‚

`src/App.vue`

```vue
<template>
  <div class="app">
    <h1>{{ msg }}ï¼Œå­¦ç”Ÿå§“åæ˜¯:{{ studentName }}</h1>
		
    <!-- é€šè¿‡çˆ¶ç»„ä»¶ç»™å­ç»„ä»¶ä¼ é€’å‡½æ•°ç±»å‹çš„propså®ç°å­ç»™çˆ¶ä¼ é€’æ•°æ® -->
    <School :getSchoolName="getSchoolName"/>

    <!-- é€šè¿‡çˆ¶ç»„ä»¶ç»™å­ç»„ä»¶ç»‘å®šä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶å®ç°å­ç»™çˆ¶ä¼ é€’æ•°æ®ï¼ˆç¬¬ä¸€ç§å†™æ³•ï¼Œä½¿ç”¨@æˆ–v-onï¼‰ -->
    <!-- <Student @atguigu="getStudentName" @demo="m1"/> -->

    <!-- é€šè¿‡çˆ¶ç»„ä»¶ç»™å­ç»„ä»¶ç»‘å®šä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶å®ç°å­ç»™çˆ¶ä¼ é€’æ•°æ®ï¼ˆç¬¬äºŒç§å†™æ³•ï¼Œä½¿ç”¨refï¼‰ -->
    <Student ref="student" @click.native="show"/> <!-- ğŸ”´native -->
  </div>
</template>

<script>
  import Student from './components/Student'
  import School from './components/School'

  export default {
    name:'App',
    components:{School,Student},
    data() {
      return {
        msg:'ä½ å¥½å•Šï¼',
        studentName:''
      }
    },
    methods: {
      getSchoolName(name){
        console.log('Appæ”¶åˆ°äº†å­¦æ ¡åï¼š',name)
      },
      getStudentName(name,...params){
        console.log('Appæ”¶åˆ°äº†å­¦ç”Ÿåï¼š',name,params)
        this.studentName = name
      },
      m1(){
        console.log('demoäº‹ä»¶è¢«è§¦å‘äº†ï¼')
      },
      show(){
        alert(123)
      }
    },
    mounted() {
      this.$refs.student.$on('atguigu',this.getStudentName) // ğŸ”´ç»‘å®šè‡ªå®šä¹‰äº‹ä»¶
      // this.$refs.student.$once('atguigu',this.getStudentName) // ç»‘å®šè‡ªå®šä¹‰äº‹ä»¶ï¼ˆä¸€æ¬¡æ€§ï¼‰
    },
  }
</script>

<style scoped>.app{background-color: gray;padding: 5px;}</style>
```

`src/components/Student.vue`

```vue
<template>
	<div class="student">
		<h2>å­¦ç”Ÿå§“åï¼š{{name}}</h2>
		<h2>å­¦ç”Ÿæ€§åˆ«ï¼š{{sex}}</h2>
		<h2>å½“å‰æ±‚å’Œä¸ºï¼š{{number}}</h2>
		<button @click="add">ç‚¹æˆ‘number++</button>
		<button @click="sendStudentlName">æŠŠå­¦ç”Ÿåç»™App</button>
		<button @click="unbind">è§£ç»‘atguiguäº‹ä»¶</button>
		<button @click="death">é”€æ¯å½“å‰Studentç»„ä»¶çš„å®ä¾‹(vc)</button>
	</div>
</template>

<script>
	export default {
		name:'Student',
		data() {
			return {
				name:'å¼ ä¸‰',
				sex:'ç”·',
				number:0
			}
		},
		methods: {
			add(){
				console.log('addå›è°ƒè¢«è°ƒç”¨äº†')
				this.number++
			},
			sendStudentlName(){
				// è§¦å‘Studentç»„ä»¶å®ä¾‹èº«ä¸Šçš„atguiguäº‹ä»¶
				this.$emit('atguigu',this.name,666,888,900)
				// this.$emit('demo')
				// this.$emit('click')
			},
			unbind(){
        // ğŸ”´è§£ç»‘
				this.$off('atguigu') //è§£ç»‘ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶
				// this.$off(['atguigu','demo']) //è§£ç»‘å¤šä¸ªè‡ªå®šä¹‰äº‹ä»¶
				// this.$off() //è§£ç»‘æ‰€æœ‰çš„è‡ªå®šä¹‰äº‹ä»¶
			},
			death(){
        // é”€æ¯äº†å½“å‰Studentç»„ä»¶çš„å®ä¾‹ï¼Œé”€æ¯åæ‰€æœ‰Studentå®ä¾‹çš„è‡ªå®šä¹‰äº‹ä»¶å…¨éƒ½ä¸å¥æ•ˆ
				this.$destroy()
			}
		},
	}
</script>

<style lang="less" scoped>
	.student{background-color: pink;padding: 5px;margin-top: 30px;}
</style>
```

**ä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶ä¼˜åŒ–Todo-List**

```vue
<template>
	<div id="root">
		<div class="todo-container">
			<div class="todo-wrap">
				<MyHeader @addTodo="addTodo"/>
				<MyList :todos="todos" :checkTodo="checkTodo" :deleteTodo="deleteTodo"/>
				<MyFooter :todos="todos" 
                  @checkAllTodo="checkAllTodo" @clearAllTodo="clearAllTodo"/>
			</div>
		</div>
	</div>
</template>

<script>
	import MyHeader from './components/MyHeader'
	import MyList from './components/MyList'
	import MyFooter from './components/MyFooter.vue'

	export default {
		name:'App',
		components:{MyHeader,MyList,MyFooter},
		data() {
			return {
				//ç”±äºtodosæ˜¯MyHeaderç»„ä»¶å’ŒMyFooterç»„ä»¶éƒ½åœ¨ä½¿ç”¨ï¼Œæ‰€ä»¥æ”¾åœ¨Appä¸­ï¼ˆçŠ¶æ€æå‡ï¼‰
				todos:JSON.parse(localStorage.getItem('todos')) || []
			}
		},
		methods: {
			//æ·»åŠ ä¸€ä¸ªtodo
			addTodo(todoObj){
				this.todos.unshift(todoObj)
			},
			//å‹¾é€‰orå–æ¶ˆå‹¾é€‰ä¸€ä¸ªtodo
			checkTodo(id){
				this.todos.forEach((todo)=>{
					if(todo.id === id) todo.done = !todo.done
				})
			},
			//åˆ é™¤ä¸€ä¸ªtodo
			deleteTodo(id){
				this.todos = this.todos.filter( todo => todo.id !== id )
			},
			//å…¨é€‰orå–æ¶ˆå…¨é€‰
			checkAllTodo(done){
				this.todos.forEach((todo)=>{
					todo.done = done
				})
			},
			//æ¸…é™¤æ‰€æœ‰å·²ç»å®Œæˆçš„todo
			clearAllTodo(){
				this.todos = this.todos.filter((todo)=>{
					return !todo.done
				})
			}
		},
		watch: {
			todos:{
				deep:true,
				handler(value){
					localStorage.setItem('todos',JSON.stringify(value))
				}
			}
		},
	}
</script>
```

`src/components/MyHeader.vue`

```vue
<template>
	<div class="todo-header">
		<input type="text" placeholder="è¯·è¾“å…¥ä½ çš„ä»»åŠ¡åç§°ï¼ŒæŒ‰å›è½¦é”®ç¡®è®¤" 
           v-model="title" @keyup.enter="add"/>
	</div>
</template>

<script>
	import {nanoid} from 'nanoid'
	export default {
		name:'MyHeader',
		data() {
			return {
				title:''	// æ”¶é›†ç”¨æˆ·è¾“å…¥çš„title
			}
		},
		methods: {
			add(){
				//æ ¡éªŒæ•°æ®
				if(!this.title.trim()) return alert('è¾“å…¥ä¸èƒ½ä¸ºç©º')
				//å°†ç”¨æˆ·çš„è¾“å…¥åŒ…è£…æˆä¸€ä¸ªtodoå¯¹è±¡
				const todoObj = {id:nanoid(),title:this.title,done:false}
				//é€šçŸ¥Appç»„ä»¶å»æ·»åŠ ä¸€ä¸ªtodoå¯¹è±¡
				this.$emit('addTodo',todoObj)
				//æ¸…ç©ºè¾“å…¥
				this.title = ''
			}
		},
	}
</script>
```

`src/components/MyFooter`

```vue
<template>
	<div class="todo-footer" v-show="total">
		<label>
			<!-- <input type="checkbox" :checked="isAll" @change="checkAll"/> -->
			<input type="checkbox" v-model="isAll"/>
		</label>
		<span>
			<span>å·²å®Œæˆ{{ doneTotal }}</span> / å…¨éƒ¨{{ total }}
		</span>
		<button class="btn btn-danger" @click="clearAll">æ¸…é™¤å·²å®Œæˆä»»åŠ¡</button>
	</div>
</template>

<script>
	export default {
		name:'MyFooter',
		props:['todos'],
		computed: {
			//æ€»æ•°
			total(){
				return this.todos.length
			},
			//å·²å®Œæˆæ•°
			doneTotal(){
				return this.todos.reduce((pre,todo)=> pre + (todo.done ? 1 : 0) ,0)
			},
			//æ§åˆ¶å…¨é€‰æ¡†
			isAll:{
				//å…¨é€‰æ¡†æ˜¯å¦å‹¾é€‰
				get(){
					return this.doneTotal === this.total && this.total > 0
				},
				//isAllè¢«ä¿®æ”¹æ—¶setè¢«è°ƒç”¨
				set(value){
					// this.checkAllTodo(value)
					this.$emit('checkAllTodo',value)
				}
			}
		},
		methods: {
			//æ¸…ç©ºæ‰€æœ‰å·²å®Œæˆ
			clearAll(){
				// this.clearAllTodo()
				this.$emit('clearAllTodo')
			}
		},
	}
</script>
```

