---
title: å…¨å±€äº‹ä»¶æ€»çº¿
date: 2022-07-08 16:09:11
permalink: /pages/fa7ac6/
categories:
  - Vue
tags:
  - 
author: 
  name: yami
  link: https://github.com/yamin-hub
---
## å…¨å±€äº‹ä»¶æ€»çº¿

ä¸€ç§å¯ä»¥åœ¨ä»»æ„ç»„ä»¶é—´é€šä¿¡çš„æ–¹å¼ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ã€‚

1. æ‰€æœ‰çš„ç»„ä»¶å¯¹è±¡éƒ½å¿…é¡»èƒ½çœ‹åˆ°å®ƒã€‚
2. è¿™ä¸ªå¯¹è±¡å¿…é¡»èƒ½å¤Ÿä½¿ç”¨**`$on`** **`$emit`**  **`$off`**æ–¹æ³•å»ç»‘å®šã€è§¦å‘å’Œè§£ç»‘äº‹ä»¶

**ä½¿ç”¨æ­¥éª¤**

1. å®šä¹‰å…¨å±€äº‹ä»¶æ€»çº¿

```js
new Vue({
   	...
   	beforeCreate() {
   		Vue.prototype.$bus = this // å®‰è£…å…¨å±€äº‹ä»¶æ€»çº¿ï¼Œ$bus å°±æ˜¯å½“å‰åº”ç”¨çš„ vm
   	},
    ...
})
```

2. ä½¿ç”¨äº‹ä»¶æ€»çº¿

   a. æ¥æ”¶æ•°æ®ï¼šAç»„ä»¶æƒ³æ¥æ”¶æ•°æ®ï¼Œåˆ™åœ¨Aç»„ä»¶ä¸­ç»™$busç»‘å®šè‡ªå®šä¹‰äº‹ä»¶ï¼Œäº‹ä»¶çš„å›è°ƒç•™åœ¨Aç»„ä»¶è‡ªèº«

```js
export default {
    methods(){
        demo(data){...}
    }
    ...
    mounted() {
        this.$bus.$on('xxx',this.demo)
    }
}
```

â€‹	b.æä¾›æ•°æ®ï¼š`this.$bus.$emit('xxx',data)`

3. æœ€å¥½åœ¨`beforeDestroy`é’©å­ä¸­ï¼Œç”¨**`$off`**å»è§£ç»‘å½“å‰ç»„ä»¶æ‰€ç”¨åˆ°çš„äº‹ä»¶

**`src/main.js`**

```js
import Vue from 'vue'
import App from './App.vue'

Vue.config.productionTip = false

new Vue({
  el:'#app',
  render: h => h(App),
  beforeCreate() {
    Vue.prototype.$bus = this // å®‰è£…å…¨å±€äº‹ä»¶æ€»çº¿
  }
})
```

**`src/App.vue`**

```vue
<template>
	<div class="app">
		<School/>
		<Student/>
	</div>
</template>

<script>
	import Student from './components/Student'
	import School from './components/School'

	export default {
		name:'App',
		components:{ School, Student }
	}
</script>

<style scoped>.app{background-color: gray;padding: 5px;}</style>
```

`src/components/School.vue`

```vue
<template>
  <div class="school">
    <h2>å­¦æ ¡åç§°ï¼š{{ name }}</h2>
    <h2>å­¦æ ¡åœ°å€ï¼š{{ address }}</h2>
  </div>
</template>

<script>
  export default {
    name: "School",
    data() {
      return {
        name: "å°šç¡…è°·",
        address: "åŒ—äº¬",
      };
    },
    mounted() {  //ğŸ”´
      // console.log('School',this)
      this.$bus.$on("hello", (data) => {
        console.log("æˆ‘æ˜¯Schoolç»„ä»¶ï¼Œæ”¶åˆ°äº†æ•°æ®", data);
      });
    },
    beforeDestroy() {  //ğŸ”´
      this.$bus.$off("hello");
    },
  };
</script>

<style scoped>.school {background-color: skyblue;padding: 5px;}</style>
```

**`src/components/Student.vue`**

```vue
<template>
  <div class="student">
    <h2>å­¦ç”Ÿå§“åï¼š{{ name }}</h2>
    <h2>å­¦ç”Ÿæ€§åˆ«ï¼š{{ sex }}</h2>
    <button @click="sendStudentName">æŠŠå­¦ç”Ÿåç»™Schoolç»„ä»¶</button> //ğŸ”´
  </div>
</template>

<script>
  export default {
    name:'Student',
    data() {
      return {
        name:'å¼ ä¸‰',
        sex:'ç”·'
      }
    },
    methods: {  //ğŸ”´
      sendStudentName(){
        this.$bus.$emit('demo', this.name)
      }
    }
  }
</script>

<style scoped>.student{background-color: pink;padding: 5px;margin-top: 30px;}</style>
```

